"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = require("react");
var types_1 = require("./types");
function useIdleCallback(callback, _a) {
    var _b = (_a === void 0 ? {} : _a).unsupportedBehavior, unsupportedBehavior = _b === void 0 ? types_1.UnsupportedBehavior.AnimationFrame : _b;
    var handle = react_1.useRef(null);
    react_1.useEffect(function () {
        if ('requestIdleCallback' in window) {
            handle.current = window.requestIdleCallback(function () { return callback(); });
        }
        else if (unsupportedBehavior === types_1.UnsupportedBehavior.AnimationFrame) {
            handle.current = window.requestAnimationFrame(function () {
                callback();
            });
        }
        else {
            callback();
        }
        return function () {
            var currentHandle = handle.current;
            handle.current = null;
            if (currentHandle == null) {
                return;
            }
            if ('cancelIdleCallback' in window) {
                window.cancelIdleCallback(currentHandle);
            }
            else if (unsupportedBehavior === types_1.UnsupportedBehavior.AnimationFrame) {
                window.cancelAnimationFrame(currentHandle);
            }
        };
    }, [callback, unsupportedBehavior]);
}
exports.useIdleCallback = useIdleCallback;
