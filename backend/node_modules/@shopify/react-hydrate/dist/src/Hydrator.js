"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var react_1 = tslib_1.__importDefault(require("react"));
var react_hooks_1 = require("@shopify/react-hooks");
var react_effect_1 = require("@shopify/react-effect");
var context_1 = require("./context");
var shared_1 = require("./shared");
exports.Hydrator = react_1.default.memo(function Hydrator(_a) {
    var _b;
    var children = _a.children, id = _a.id;
    var manager = react_1.default.useContext(context_1.HydrationContext);
    var hydrationId = react_hooks_1.useLazyRef(function () { return manager.hydrationId(id); }).current;
    var hydrationProps = (_b = {}, _b[shared_1.HYDRATION_ATTRIBUTE] = hydrationId, _b);
    react_effect_1.useServerEffect(function () { }, manager.effect);
    return children ? (react_1.default.createElement("div", tslib_1.__assign({}, hydrationProps), children)) : (react_1.default.createElement("div", tslib_1.__assign({}, hydrationProps, { dangerouslySetInnerHTML: {
            __html: manager.getHydration(hydrationId) || '',
        } })));
});
